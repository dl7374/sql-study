
-- INSERT
-- 테이블 구조 확인
DESC departments;

-- INSERT의 첫번째 방법 (모든 컬럼 데이터를 한 번에 지정해서 삽입)
INSERT INTO departments
VALUES (300, '개발부'); -- 에러 -> 컬럼을 지정하지 않고 값만 주는 경우에는 모든 값을 다 줘야 한다. (NULL 허용 여부 상관 없이)

SELECT * FROM departments;
ROLLBACK; -- 실행 시점을 다시 뒤로 되돌리는 키워드

-- INSERT의 두번째 방법 (직접 컬럼을 지정하고 저장, NOT NULL 컬럼을 확인하세요!)
INSERT INTO departments
    (department_id, location_id) -- 에러 -> department_name이 NOT NULL!
VALUES
    (301, 1500);
    
-- 사본 테이블 생성
-- 사본 테이블을 생성할 때 그냥 생성하면 -> 조회된 데이터가지 모두 복사
-- WHERE절에 false값 (1 = 2) 지정하면 -> 테이블의 구조만 복사되고 데이터는 복사 x
-- CTAS문은 컬럼의 구조와 데이터를 복사할 뿐, 제약조건(PK, FK....)은 복제되지 않습니다.
CREATE TABLE emps AS
(SELECT employee_id, first_name, job_id, hire_date
FROM employees WHERE 1 = 2);

SELECT * FROM emps;
DROP TABLE emps;

-- INSERT (서브쿼리)
INSERT INTO emps
(SELECT employee_id, first_name, job_id, hire_date
FROM employees where department_id = 50);

select * from emps
where employee_id = 120;

---------------------------------------------------------------

-- UPDATE
-- UPDATE 테이블이름 SET 컬럼=값, 컬럼=값.... WHERE 누구를 수정할지(조건)
create table emps as
(select * from employees);

select * from emps;

-- UPDATE를 진핼할 때는 누구를 수정할 지 조건으로 잘 지목해야 합니다.
-- 그렇지 않으면 수정 대상이 전체 테이블로 지정됩니다.
UPDATE emps set salary = 30000;
rollback;

UPDATE emps set salary = 30000
where employee_id =100;
select * from emps;

UPDATE emps set salary = salary + salary*0.1
where employee_id =100;

update emps
set phone_number = '010.4742.8917', manager_id = 102
where employee_id = 100;

-- UPDATE (서브쿼리)
UPDATE emps
SET (job_id, salary, manager_id) = 
    (
        select job_id, salary, manager_id
        from emps
        where employee_id = 100
    )
where employee_id =101;
rollback;


------------------------------------------------------------------

-- DELETE
-- DELETE WHERE 지정하지 않으면 테이블 전체 행이 대상이 됩니다.
DELETE FROM emps
where employee_id = 103;

-- DELETE (서브쿼리)
delete from emps
where department_id = (select department_id from departments
                       where department_name = 'IT');



